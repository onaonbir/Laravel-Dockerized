[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/laravel

[program:octane]
command=php artisan octane:start --server=frankenphp --host=0.0.0.0 --port=8080 --admin-port=2019 --workers=4 --max-requests=1000
directory=/app
autostart=true
autorestart=unexpected
user=www-data
stdout_logfile=/var/log/laravel/octane.log
stderr_logfile=/var/log/laravel/octane_error.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile_backups=5
stopwaitsecs=60
stopsignal=TERM
killasgroup=true
priority=100
startsecs=10
startretries=3
exitcodes=0

[program:horizon]
command=php artisan horizon
directory=/app
autostart=true
autorestart=unexpected
user=www-data
stdout_logfile=/var/log/laravel/horizon.log
stderr_logfile=/var/log/laravel/horizon_error.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile_backups=5
stopwaitsecs=60
stopsignal=TERM
killasgroup=true
priority=200
startsecs=5
startretries=3
exitcodes=0

[program:scheduler]
command=php artisan schedule:work
directory=/app
autostart=true
autorestart=unexpected
user=www-data
stdout_logfile=/var/log/laravel/scheduler.log
stderr_logfile=/var/log/laravel/scheduler_error.log
stdout_logfile_maxbytes=5MB
stderr_logfile_maxbytes=5MB
stdout_logfile_backups=3
stderr_logfile_backups=3
stopwaitsecs=30
stopsignal=TERM
priority=400
startsecs=5
startretries=3
exitcodes=0

[program:cron]
command=cron -f
autostart=true
autorestart=unexpected
user=root
stdout_logfile=/var/log/laravel/cron.log
stderr_logfile=/var/log/laravel/cron_error.log
stdout_logfile_maxbytes=5MB
stderr_logfile_maxbytes=5MB
stdout_logfile_backups=3
stderr_logfile_backups=3
priority=300
startsecs=1
startretries=2

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface
